(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35d097a8"],{"43c1":function(t,a,e){"use strict";e.d(a,"h",(function(){return o})),e.d(a,"c",(function(){return n})),e.d(a,"e",(function(){return i})),e.d(a,"d",(function(){return l})),e.d(a,"a",(function(){return d})),e.d(a,"g",(function(){return s})),e.d(a,"f",(function(){return c})),e.d(a,"i",(function(){return m})),e.d(a,"b",(function(){return u}));e("55dd");var r=e("66df"),o=function(t){return r["a"].request({url:"/api/data/article",data:t,method:"post"})},n=function(t){return r["a"].request({url:"/api/data/article/search/column-property?value="+t,method:"get"})},i=function(t){var a="";return a=t.title&&t.title.length>0?"/api/data/article/search/title_column-property_page?title=%25"+t.title+"%25&columnProperty="+t.columnProperty+"&page="+t.page+"&size="+t.size+"&sort="+t.sort:"/api/data/article/search/column-property_page?columnProperty="+t.columnProperty+"&page="+t.page+"&size="+t.size+"&sort="+t.sort,r["a"].request({url:a,method:"get"})},l=function(t){var a="";return a=t.title&&t.title.length>0?"/api/data/article/search/column-id_title_page?title=%25"+t.title+"%25&columnId="+t.columnId+"&page="+t.page+"&size="+t.size+"&sort="+t.sort:"/api/data/article/search/column-id_page?columnId="+t.columnId+"&page="+t.page+"&size="+t.size+"&sort="+t.sort,r["a"].request({url:a,method:"get"})},d=function(t){return r["a"].request({url:"/api/data/article/"+t,method:"delete"})},s=function(t){return r["a"].request({url:"/api/data/column/search/top-column?property="+t,method:"get"})},c=function(t){return r["a"].request({url:"/api/data/column/"+t+"/children",method:"get"})},m=function(t){return r["a"].request({url:"/api/data/column",data:t,method:"post"})},u=function(t){return r["a"].request({url:"/api/data/column/"+t,method:"delete"})}},"4de9":function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Row",{staticClass:"main-row"},[e("Col",{staticStyle:{height:"100%"},attrs:{span:"6"}},[e("Card",{staticClass:"tree-card-body"},[e("p",{attrs:{slot:"title"},slot:"title"},[e("Icon",{attrs:{type:"ios-cube-outline"}}),t._v("\n       栏目树\n     ")],1),e("Tree",{attrs:{data:t.tableData,"load-data":t.loadTreeChildren},on:{"on-select-change":t.handleClickNode}})],1)],1),e("Col",{staticClass:"rightCol",attrs:{span:"18"}},[e("Card",{staticClass:"tree-card-body"},[e("p",{attrs:{slot:"title"},slot:"title"},[e("Icon",{attrs:{type:"ios-document-outline"}}),t._v("\n       栏目详情\n     ")],1),e("Form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataFormRules,"label-position":"right","label-width":80}},[e("FormItem",{attrs:{label:"栏目图片"}},[e("Upload",{ref:"upload",staticStyle:{width:"198px",height:"198px"},attrs:{"show-upload-list":!1,type:"drag","on-success":t.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.handleBeforeUpload,action:"/api/attachment/upload"}},[e("div",{staticStyle:{width:"198px",height:"198px","line-height":"198px"}},[e("Icon",{directives:[{name:"show",rawName:"v-show",value:0==t.dataForm.imgUrl.length,expression:"dataForm.imgUrl.length == 0"}],attrs:{type:"ios-camera",size:"60"}}),e("img",{staticStyle:{"max-width":"100%","max-height":"100%"},attrs:{src:t.dataForm.imgUrl}})],1)])],1),e("FormItem",{attrs:{label:"编码",prop:"code"}},[e("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入编码..."},model:{value:t.dataForm.code,callback:function(a){t.$set(t.dataForm,"code",a)},expression:"dataForm.code"}})],1),e("FormItem",{attrs:{label:"名称",prop:"name"}},[e("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入名称..."},model:{value:t.dataForm.name,callback:function(a){t.$set(t.dataForm,"name",a)},expression:"dataForm.name"}})],1),e("FormItem",{attrs:{label:"英语名称",prop:"enName"}},[e("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入英语名称..."},model:{value:t.dataForm.enName,callback:function(a){t.$set(t.dataForm,"enName",a)},expression:"dataForm.enName"}})],1),e("FormItem",{attrs:{label:"父节点",prop:"parentName"}},[e("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"请选择父节点...",readonly:""},nativeOn:{click:function(a){return t.showParentDialog.apply(null,arguments)}},model:{value:t.dataForm.parentName,callback:function(a){t.$set(t.dataForm,"parentName",a)},expression:"dataForm.parentName"}})],1),e("FormItem",{attrs:{label:"排序值",prop:"orderValue"}},[e("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入排序值..."},model:{value:t.dataForm.orderValue,callback:function(a){t.$set(t.dataForm,"orderValue",a)},expression:"dataForm.orderValue"}})],1),e("FormItem",{attrs:{label:"显示"}},[e("i-switch",{attrs:{value:t.dataForm.displayFlag}})],1),e("FormItem",{attrs:{label:"备注"}},[e("Input",{staticStyle:{width:"600px"},attrs:{type:"textarea",placeholder:"请输入备注...",rows:6},model:{value:t.dataForm.memo,callback:function(a){t.$set(t.dataForm,"memo",a)},expression:"dataForm.memo"}})],1),e("div",{staticClass:"buttonBorder"},[e("Button",{attrs:{type:"info"},on:{click:t.handleClearForm}},[t._v("新 建")]),e("Button",{attrs:{type:"primary"},on:{click:t.saveData}},[t._v("保 存")]),e("Button",{attrs:{type:"warning"},on:{click:t.handleRemove}},[t._v("删 除")])],1)],1)],1)],1),t.infoDialogVisible?e("div",{staticClass:"infoDialog"},[e("Card",{staticClass:"dialogCard"},[e("p",{attrs:{slot:"title"},slot:"title"},[e("Icon",{attrs:{type:"ios-cube-outline"}}),t._v("\n               请选择父节点\n           ")],1),e("a",{attrs:{slot:"extra",href:"#"},on:{click:function(a){return a.preventDefault(),t.closeParentDialog.apply(null,arguments)}},slot:"extra"},[e("Icon",{attrs:{type:"ios-close"}}),t._v("\n           关闭\n           ")],1),e("Tree",{attrs:{data:t.tableData,"load-data":t.loadTreeChildren},on:{"on-select-change":t.handleSelectParentNode}})],1)],1):t._e()],1)},o=[],n=(e("7f7f"),e("ac6a"),e("43c1")),i=e("e069"),l={data:function(){return{infoDialogVisible:!1,dataForm:{id:null,code:"",name:"",enName:"",pid:null,parentName:"",iconId:null,imgUrl:"",orderValue:"50",property:this.$config.columnProperty.COMMON,displayFlag:!0,memo:""},dataFormRules:{name:[{required:!0,message:"名称必须输入",trigger:"blur"}],orderValue:[{required:!0,message:"请输入排序值",trigger:"blur"}]},tableData:[],size:10,totalElements:0,totalPages:0,page:1}},mounted:function(){this.dataForm.columnProperty=this.$config.columnProperty.COMMON,this.loadData()},methods:{loadData:function(){var t=this;this.tableData=[],Object(n["g"])(this.dataForm.columnProperty).then((function(a){a.data._embedded.cmsColumns.forEach((function(a){t.tableData.push(t.convertToTreeNode(a))}))}))},loadTreeChildren:function(t,a){var e=this;Object(n["f"])(t.id).then((function(t){var r=[];t.data._embedded.cmsColumns.forEach((function(t){r.push(e.convertToTreeNode(t))})),a(r)}))},convertToTreeNode:function(t){var a=this,e={id:t.id,code:t.code,name:t.name,enName:t.enName,pid:t.pid,parentName:t.parentName,iconId:t.iconId,orderValue:t.orderValue,property:t.property,displayFlag:t.displayFlag,memo:t.memo,title:t.name,expand:!1,children:[],loading:!1};return t.children&&t.children.length>0&&t.children.forEach((function(t){e.children.push(a.convertToTreeNode(t))})),e},handleClickNode:function(t){if(t&&t.length>0){var a=t[0];this.dataForm.id=a.id,this.dataForm.code=a.code,this.dataForm.name=a.name,this.dataForm.enName=a.enName,this.dataForm.pid=a.pid,this.dataForm.parentName=a.parentName,this.dataForm.iconId=a.iconId,this.dataForm.imgUrl=a.iconId?"/api/attachment/get/"+a.iconId:"",this.dataForm.orderValue=a.orderValue+"",this.dataForm.displayFlag=a.displayFlag,this.dataForm.memo=a.memo}},handleEdit:function(t){this.dataForm.id=t.id,this.dataForm.title=t.title,this.dataForm.url=t.url,this.infoDialogVisible=!0},handleRemove:function(){var t=this;this.dataForm.id&&i["Modal"].confirm({title:"确认删除吗？",onOk:function(){Object(n["b"])(t.dataForm.id).then((function(a){t.handleClearForm(),t.loadData(),t.$Message.info("删除成功")}))},onCancel:function(){}})},showParentDialog:function(){this.infoDialogVisible=!0},closeParentDialog:function(){this.infoDialogVisible=!1},handleSelectParentNode:function(t){if(t&&t.length>0){var a=t[0];if(this.validateParentId(a,this.dataForm.id))return this.dataForm.pid=a.id,this.dataForm.parentName=a.title,void this.closeParentDialog()}this.dataForm.pid=null,this.dataForm.parentName="",this.closeParentDialog()},validateParentId:function(t,a){if(t.id===a)return!1;if(t.children&&t.children.length>0)for(var e in t.children)if(!this.validateParentId(e,a))return!1;return!0},handleClearForm:function(){this.dataForm.id=null,this.dataForm.code="",this.dataForm.name="",this.dataForm.enName="",this.dataForm.pid=null,this.dataForm.parentName="",this.dataForm.iconId=null,this.dataForm.imgUrl="",this.dataForm.orderValue="50",this.dataForm.property=this.$config.columnProperty.COMMON,this.dataForm.displayFlag=!0,this.dataForm.memo=""},saveData:function(){var t=this;this.$refs["dataForm"].validate((function(a){a&&Object(n["i"])(t.dataForm).then((function(a){t.handleClearForm(),t.loadData(),t.$Message.info("保存成功")}))}))},handleSuccess:function(t,a){t&&t.rows&&t.rows.length>0&&(this.dataForm.imgUrl="/api/attachment/get/"+t.rows[0].id,this.dataForm.iconId=t.rows[0].id)},handleFormatError:function(t){this.$Notice.warning({title:"文件格式不正确",desc:"选中文件 "+t.name+" 的格式错误, 请选择 jpg 或 png 文件."})},handleMaxSize:function(t){this.$Notice.warning({title:"超出文件大小限制",desc:"选中文件  "+t.name+" 太大, 不应该超过 2M."})},handleBeforeUpload:function(){var t=!0;return t}}},d=l,s=(e("7669"),e("2877")),c=Object(s["a"])(d,r,o,!1,null,"64762904",null);a["default"]=c.exports},7669:function(t,a,e){"use strict";e("8900")},8900:function(t,a,e){}}]);